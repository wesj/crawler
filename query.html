<html>
	<head>
		<title>Title</title>
		<style text="text/css">
html, body {
	padding: 0;
	margin: 0;
	font-family: sans-serif;
}
ul {
	padding: 0;
	margin: 0;
}
li {
	list-style-type: none;
	list-style-image: none;
	margin: 0;
	padding: 0.5em 0;
	border-bottom: 1px solid darkgray;
	overflow: hidden;
}
li > a {
	text-decoration: none;
}

li > a > .title {
	height: 1em;
	overflow: hidden;
	color: black;
}

li > a > .title > span.host {
	padding-left: 1em;
	color: darkgray;
}
li > a > div.description {
	color: darkgray;
	padding: 0.5em 0;
}
li > a > div.url {
	color: blue;
	text-decoration: underline;
	font-size: smaller;
}
li > a > img {
	width: 3em;
	height: 3em;
	float: left;
	margin-right: 0.5em;
}
		</style>
	</head>
	<body>
		<input id="searchBox" type="search" placeholder="Search">
<script async="async" type="text/javascript">
//<![CDATA[/*
function loadJSON(src) {
	return new Promise(function(resolve, reject) {
		var request = new XMLHttpRequest();
		request.onreadystatechange = function() {
			if (request.readyState === XMLHttpRequest.DONE) {
				resolve(JSON.parse(request.response));
			}
		}
		request.open('GET', src, true);
		request.send(null);
	});
}

var siteList;
window.addEventListener("load", function() {
	siteList = document.querySelector("#sites");
	Promise.all([loadJSON("pageList copy.json"),
				 loadJSON("words copy.json")]).then(function(res) {

		console.log(res[0].indices.length, "unique urls found");
		console.log(Object.keys(res[0].data).length, "Urls visited");
		console.log(Object.keys(res[1].list).sort(function(a, b) {
			return res[1].list[b].length - res[1].list[a].length;
			}), "words indexed");
		var input = document.querySelector("#searchBox");
		input.addEventListener("input", function() {
			var words = input.value.split(/\s+/);
			var results = [];
			var result = words.forEach(function(word) {
				var wordresults = res[1].list[word];
				if (wordresults) {
					wordresults.forEach(function(res) {
						if (results.indexOf(res == -1)) {
							results.push(res);
						}
					});
				}

				results.sort(function(a, b) {
					if (!a.linkedBy || !b.linkedBy) return 0;
					return a.linkedBy.length - b.linkedBy.length;
				});
				if (results.length > 0) {
					var sites = results.map(function(result) {
						var url = res[0].indices[result];
						return res[0].data[url];
					});

					showresults(sites);
				}
			})
		})
	});
});

function showresults(sites) {
	siteList.innerHTML = "";

	sites.forEach(function(site) {
		var a = document.createElement("a");
		var url = site.scheme + "://" + site.host + site.path + site.hash + site.search;
		a.innerHTML = (site.opengraph.image ? 	("<img src='" + site.opengraph.image + "'>") : "") +
			"<div class='title'>" + (site.title || site.url) + "<span class='host'>" + site.host + "</span></div>" +
			"<div class='description'>" + (site.description || "") + "</div>" +
			"<span class='url'>" + url + "</span>";

		a.href = url

		var li = document.createElement("li");
		li.appendChild(a);
		siteList.appendChild(li);
	});
}
//]]>
</script> 
	<ol id="sites"></ol>
	</body>
</html>